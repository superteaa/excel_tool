### `main` 函数

此函数是程序的主入口点，用于加载Excel文件，提取数据，并根据指定的`sta`调用`process_c_cycle`或`process_d_cycle`函数来处理数据。

#### 参数:

- `work_name`: Excel文件的名称。
- `min_v`: C值的最小阈值。
- `max_v`: C值的最大阈值。
- `sta`: 状态参数，决定使用哪个处理函数。
- `c_output_name`: 充电数据保存到这个文件名。
- `d_output_name`: 放电数据将保存到这个文件名。

#### 工作流程:

1. 加载Excel文件并打印加载完成的信息。
2. 提取工作表中的数据，将每行数据存储为字典，并添加到列表`sheet_data`中。
3. 计算最大循环编号`max_cycle`。
4. 创建一个新的工作簿和工作表，设置标题和列头。
5. 根据`sta`的值，使用多进程池来并行处理每个循环。
6. 将处理结果写入新的工作表。
7. 保存工作簿到指定的输出文件名。

### `process_c_cycle` 

此函数用于处理循环(`check_cycle`)相关的数据，并计算C值的平均值和标准差。检查SOH值。

#### 参数:

- `check_cycle`: 要检查的循环编号。
- `sheet_data`: 包含数据的列表，每个元素都是一个包含数据行的字典。
- `min_v`: C值的最小阈值。
- `max_v`: C值的最大阈值。

#### 返回值:

如果找到符合条件的C值，则返回一个元组，包含：

- 循环编号(`check_cycle`)
- C值的平均值(`average_value`)
- C值的标准差(`std_dev`)
- 结果检查值(`result_check`)，即标准差除以平均值
- SOH值

#### 工作流程:

1. 使用列表推导式从`sheet_data`中选择符合特定循环编号和B值大于等于5的C值。
2. 计算这些C值的平均值和标准差。
3. 获取SOH
4. 返回结果。

### `process_d_cycle` 

此函数与`process_c_cycle`类似，但用于处理B值小于0的情况。

#### 参数:

- `check_cycle`: 要检查的循环编号。
- `sheet_data`: 包含数据的列表，每个元素都是一个包含数据行的字典。
- `min_v`: C值的最小阈值。
- `max_v`: C值的最大阈值。

#### 返回值:

如果找到符合条件的C值，则返回一个元组，包含：

- 循环编号(`check_cycle`)
- C值的平均值(`average_value`)
- C值的标准差(`std_dev`)
- 离散数(`result_check`)
- SOH值

#### 工作流程:

1. 使用列表推导式从`sheet_data`中选择符合特定循环编号和B值小于0的C值。
2. 计算这些C值的平均值和标准差。
3. 获取SOH值。
4. 返回结果

### `img_window` 

本函数用于从Excel工作簿中读取电池充放电数据，计算其状态健康度（SOH），并通过散点图和拟合线可视化展示结果。用户可以复制线性回归公式和决定系数（R^2），并将图表导出为PNG图片。

#### 功能：

- 从Excel文件中读取电压（CV‰）和状态健康度（SOH%）
- 计算数据的平均值、拟合线的斜率（k）和截距（b）。
- 在Tkinter窗口中嵌入Matplotlib图表，展示散点图和最佳拟合线。
- 提供复制线性公式和R^2值到剪贴板的功能。
- 提供将图表导出为PNG图片的功能。

#### 参数：
1. 运行`img_window`函数，传入相应参数：
   - `output_name`: 输出Excel文件的名称。
   - `min_v`: 图表标题中的最小电压值。
   - `max_v`: 图表标题中的最大电压值。
   - `sta`: 状态指示符，'A'表示充电，'B'表示放电。

#### **工作流程：**

1. 在main()函数运算完excel的数据，并保存后，调用本函数，并传入相应参数
2. 根据传入的output_name，创建窗口，并展示数据图像
3. 公式和R^2的值可复制
4. 数据图像可导出为PNG图片
5. 无返回结果

### `Tips：`

- 值得注意的是，如果运算充电时的数据，则充电的最小电压和最大电压不能为空。

- 同理，如果运算放电时的数据，则放电的最小电压和最大电压也不能为空。

- 如果对电压阈值没有要求，可以在最小电压填入0，最大电压填入999
